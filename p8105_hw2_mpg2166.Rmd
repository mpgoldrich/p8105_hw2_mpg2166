---
title: "P8105 Homework 2"
author: "Madison Goldrich - mpg2166"
output: github_document
---

```{r}
library(tidyverse)
```


## Problem 1

First, clean the data in pols-month.csv

```{r}
pols_month_df =
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") |> 
  separate(
    mon,
    sep = "-",
    into = c("year", "month", "day")
  ) |> 
  mutate(
    month = case_match(
      month,
      "01" ~ "Jan",
      "02" ~ "Feb",
      "03" ~ "Mar",
      "04" ~ "Apr",
      "05" ~ "May",
      "06" ~ "Jun",
      "07" ~ "Jul",
      "08" ~ "Aug",
      "09" ~ "Sep",
      "10" ~ "Oct",
      "11" ~ "Nov",
      "12" ~ "Dec"
    )
  ) |> 
  mutate(
    president = case_match(
      prez_gop,
      0 ~ "dem",
      1 ~ "gop"
     )
    ) |> 
  select(-day, -prez_gop, -prez_dem)
```

Second, clean the data in snp.csv

```{r}
snp_df =
  read_csv("data/fivethirtyeight_datasets/snp.csv") |> 
    separate(
    date,
    sep = "/",
    into = c("month", "day", "year")
  ) |> 
  mutate(
    year = as.numeric(year),
    month = as.numeric(month)
  ) |> 
  mutate(
    year = case_when(
      year <=15 ~ year + 2000,
      year > 15 ~ year + 1900
    )
  ) |> 
  select(year, month, close) |> 
  arrange(year, month) |> 
  mutate(
    month = case_match(
      month,
      1  ~ "Jan",
      2  ~ "Feb",
      3  ~ "Mar",
      4  ~ "Apr",
      5  ~ "May",
      6  ~ "Jun",
      7  ~ "Jul",
      8  ~ "Aug",
      9  ~ "Sep",
      10 ~ "Oct",
      11 ~ "Nov",
      12 ~ "Dec"
    )
  ) |> 
  mutate(
    year = as.character(year)
  )
```

Third, tidy the unemployment data so that it can be merged with the previous datasets.

```{r}
unemployment_df =
  read.csv("data/fivethirtyeight_datasets/unemployment.csv") |> 
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |> 
  janitor::clean_names() |> 
  mutate(
    year = as.character(year)
  )
```

Join the datasets

```{r}
pols_snp_df =
  left_join(pols_month_df, snp_df)

five_thirty_eight_df =
  left_join(pols_snp_df, unemployment_df)
```

The pols-month dataset initially contained 9 variables related to the number of national politicians (i.e., president, senators, representatives, etc.) who were democratic or republican at any given time. The snp dataset contained the closing values of the S&P stock index (`close`) on the associated date. Unemployment dataset contained the percentage of unemployment (`unemployment`) in the associated month/year. The resulting merged dataset is `r nrow(five_thirty_eight_df)` rows by `r ncol(five_thirty_eight_df)` columns. Years in which data was collected range from `r min(pull(five_thirty_eight_df, year))` to `r max(pull(five_thirty_eight_df, year))`.